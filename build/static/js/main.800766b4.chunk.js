(this.webpackJsonpundefined=this.webpackJsonpundefined||[]).push([[0],{279:function(e,t,n){},280:function(e,t,n){"use strict";n.r(t);var r,a=n(0),c=n.n(a),s=n(13),i=n.n(s),o=n(12),u=n.n(o),l=n(16),d=n(39),j=n(28),p=n(23),b=n(40),f=n(226),h=n(50),O=n.n(h),v="/api/blogs",m=null,x={getAll:function(){return O.a.get(v).then((function(e){return e.data}))},create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,O.a.post(v,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),setToken:function(e){m="bearer ".concat(e)},update:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.put("".concat(v,"/").concat(t),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),remove:function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:m}},e.next=3,O.a.delete("".concat(v,"/").concat(t),n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),addComment:function(){var e=Object(l.a)(u.a.mark((function e(t,n){var r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("".concat(v,"/").concat(t,"/comments"),n);case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=1e3*t;return clearTimeout(r),function(){var t=Object(l.a)(u.a.mark((function t(a){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a({type:"SET_NOTIFICATION",payload:{message:e.message,status:e.status}}),r=setTimeout((function(){a({type:"CLEAR_NOTIFICATION"})}),n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_NOTIFICATION":return t.payload;case"CLEAR_NOTIFICATION":return null;default:return e}},w=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){var r;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,x.create(e);case 2:r=t.sent,n({type:"NEW_BLOG",payload:r});case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},k=function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x.update(e,t);case 2:a=n.sent,r({type:"UPDATE_BLOG",payload:{data:a,id:e}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()},S=function(e){return function(){var t=Object(l.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x.remove(e);case 3:n({type:"REMOVE_BLOG",payload:{id:e}}),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n(g({message:t.t0.response.data.error,status:"error"}));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_BLOGS":return t.payload;case"NEW_BLOG":return[].concat(Object(f.a)(e),[t.payload]);case"UPDATE_BLOG":var n=t.payload.id,r=e.map((function(e){return e.id!==n?e:t.payload.data}));return r;case"REMOVE_BLOG":var a=t.payload.id;return e.filter((function(e){return e.id!==a}));default:return e}},I=n(113),C=n(187),L=n(137),N=n(176),E=n(6),B=function(e){var t=e.comment;return Object(E.jsx)(b.ListItem,{disableGutters:!0,divider:!0,children:Object(E.jsx)(b.ListItemText,{children:t})})},U=function(e){var t=e.comments,n=e.createComment;return Object(E.jsxs)(L.a,{my:2,children:[Object(E.jsx)(I.a,{variant:"h5",component:"h3",gutterBottom:!0,children:"comments"}),Object(E.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=e.target.comment.value;e.target.comment.value="",n(t)},children:[Object(E.jsx)("input",{name:"comment"}),Object(E.jsx)("button",{type:"submit",children:"add comment"})]}),Object(E.jsx)(b.List,{dense:!0,children:t.map((function(e){return Object(E.jsx)(B,{comment:e.content},e.id)}))})]})},_=function(e){var t,n=e.setNotification,r=Object(p.f)().id,a=Object(j.c)((function(e){return e.blogs.find((function(e){return e.id===r}))})),c=Object(j.b)(),s=function(){var e=Object(l.a)(u.a.mark((function e(){var t,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.comments.map((function(e){return e.id})),r={title:a.title,author:a.author,url:a.url,likes:a.likes+1,user:a.user.id,comments:t};try{c(k(a.id,r))}catch(s){n(s.response.data.error,"error")}case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.confirm("Remove blog ".concat(a.title," by ").concat(a.author))&&c(S(a.id));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a?Object(E.jsxs)("div",{className:"blog",children:[Object(E.jsxs)(I.a,{variant:"h4",component:"h2",gutterBottom:!0,children:[a.title," ",a.author]}),Object(E.jsx)(C.a,{color:"primary",href:a.url,target:"_blank",rel:"noreferrer",children:a.url}),Object(E.jsxs)(I.a,{variant:"body1",component:"div",children:["likes ",a.likes,Object(E.jsx)(L.a,{component:"span",ml:1,children:Object(E.jsx)(N.a,{variant:"contained",color:"primary",size:"small",onClick:s,children:"like"})})]}),Object(E.jsxs)(I.a,{variant:"body1",component:"div",children:["added by ",a.author]}),Object(E.jsx)(L.a,{mt:1,children:Object(E.jsx)(N.a,{variant:"contained",size:"small",onClick:i,children:"remove"})}),Object(E.jsx)(U,{comments:a.comments,createComment:(t=a.id,function(e){c(function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,x.addComment(e,{comment:t});case 2:a=n.sent,r({type:"UPDATE_BLOG",payload:{data:a,id:e}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}(t,e))})})]}):null},A=n(217),G=function(e){var t=e.username,n=e.password,r=e.handleLogin,a=e.handleUsernameChange,c=e.handlePasswordChange;return Object(E.jsxs)("form",{onSubmit:r,children:[Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"username",label:"username",value:t,onChange:a,required:!0})}),Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"password",label:"password",type:"password",value:n,onChange:c,required:!0})}),Object(E.jsx)(L.a,{mt:1,children:Object(E.jsx)(N.a,{variant:"contained",color:"primary",type:"submit",children:"login"})})]})},R=function(e){var t=e.createBlog,n=Object(a.useState)(""),r=Object(d.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)(""),o=Object(d.a)(i,2),u=o[0],l=o[1],j=Object(a.useState)(""),p=Object(d.a)(j,2),b=p[0],f=p[1];return Object(E.jsxs)("div",{children:[Object(E.jsx)(I.a,{variant:"h4",component:"h2",gutterBottom:!0,children:"Create new"}),Object(E.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({title:c,author:u,url:b}),s(""),l(""),f("")},children:[Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"title",label:"title",value:c,onChange:function(e){var t=e.target;return s(t.value)},variant:"outlined"})}),Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"author",label:"author",value:u,onChange:function(e){var t=e.target;return l(t.value)},variant:"outlined"})}),Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"url",label:"url",value:b,onChange:function(e){var t=e.target;return f(t.value)},variant:"outlined"})}),Object(E.jsx)(L.a,{my:1,children:Object(E.jsx)(N.a,{variant:"contained",color:"primary",type:"submit",children:"create"})})]})]})},D=n(362),q=function(e){var t=e.notification;return null===t?null:Object(E.jsx)(D.a,{severity:t.status,children:t.message})},P=c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),r=Object(d.a)(n,2),c=r[0],s=r[1],i={display:c?"none":""},o={display:c?"":"none"},u=function(){s(!c)};return Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:u}})),Object(E.jsxs)(L.a,{mt:2,children:[Object(E.jsx)("div",{style:i,children:Object(E.jsx)(N.a,{variant:"contained",onClick:u,children:e.buttonLabel})}),Object(E.jsxs)("div",{style:o,children:[e.children,Object(E.jsx)(N.a,{variant:"contained",color:"secondary",onClick:u,children:"cancel"})]})]})}));P.displayName="Togglable";var z=P,F=function(e){var t=e.handleSignUp,n=Object(a.useState)(""),r=Object(d.a)(n,2),c=r[0],s=r[1],i=Object(a.useState)(""),o=Object(d.a)(i,2),u=o[0],l=o[1],j=Object(a.useState)(""),p=Object(d.a)(j,2),b=p[0],f=p[1];return Object(E.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t({username:c,name:u,password:b}),s(""),l(""),f("")},children:[Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"username",label:"username",value:c,onChange:function(e){var t=e.target;return s(t.value)},required:!0})}),Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"name",label:"name",value:u,onChange:function(e){var t=e.target;return l(t.value)},required:!0})}),Object(E.jsx)("div",{children:Object(E.jsx)(A.a,{id:"password",label:"password",type:"password",value:b,onChange:function(e){var t=e.target;return f(t.value)},required:!0})}),Object(E.jsx)(L.a,{mt:1,children:Object(E.jsx)(N.a,{variant:"contained",color:"primary",type:"submit",children:"Sign Up"})})]})},J={login:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=function(e,t){return function(){var n=Object(l.a)(u.a.mark((function n(r){var a;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,J.login({username:e,password:t});case 3:a=n.sent,x.setToken(a.token),window.localStorage.setItem("loggedBlogappUser",JSON.stringify(a)),r({type:"LOGIN",payload:a}),n.next=12;break;case 9:n.prev=9,n.t0=n.catch(0),r(g({message:n.t0.response.data.error,status:"error"},3));case 12:case"end":return n.stop()}}),n,null,[[0,9]])})));return function(e){return n.apply(this,arguments)}}()},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return t.payload;case"LOGOUT":return null;default:return e}},W=n(46),H="/api/users",K={getAll:function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.get(H);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),create:function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.post(H,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},Q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"INIT_USERS":return t.payload;default:return e}},X=n(211),Y=n(81),Z=n(207),$=n(212),ee=n(214),te=n(210),ne=n(208),re=function(){var e=Object(j.c)((function(e){return e.users})),t=Object(j.b)();return Object(a.useEffect)((function(){t(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.getAll();case 2:n=e.sent,t({type:"INIT_USERS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(E.jsxs)("div",{children:[Object(E.jsx)("h2",{children:"Users"}),Object(E.jsx)(X.a,{component:Y.a,children:Object(E.jsxs)(Z.a,{children:[Object(E.jsx)($.a,{children:Object(E.jsxs)(ee.a,{children:[Object(E.jsx)(te.a,{children:"User"}),Object(E.jsx)(te.a,{children:"blogs created"})]})}),Object(E.jsx)(ne.a,{children:e.map((function(e){return Object(E.jsxs)(ee.a,{children:[Object(E.jsx)(te.a,{children:Object(E.jsx)(W.b,{to:"/users/".concat(e.id),children:e.name})}),Object(E.jsx)(te.a,{children:e.blogs.length})]},e.id)}))})]})})]})},ae=function(e){var t=e.blogs;return Object(E.jsx)(b.List,{class:"blogs",children:t.map((function(e){return Object(E.jsx)(b.ListItem,{component:W.b,to:"/blogs/".concat(e.id),button:!0,divider:!0,children:Object(E.jsx)(b.ListItemText,{children:e.title})},e.id)}))})},ce=function(){var e=Object(p.f)().id,t=Object(j.c)((function(t){return t.users.find((function(t){return t.id===e}))}));return t?Object(E.jsxs)("div",{children:[Object(E.jsxs)(I.a,{variant:"h4",component:"h2",children:[t.name,"'s blogs"]}),Object(E.jsx)(ae,{blogs:t.blogs})]}):null},se=n(174),ie=n(213),oe=n(172),ue=Object(oe.a)({typographyStyle:{textTransform:"uppercase"}}),le=function(){var e=Object(j.c)((function(e){return e.user})),t=Object(j.b)(),n=ue();return Object(E.jsx)(se.a,{position:"static",children:Object(E.jsxs)(ie.a,{children:[Object(E.jsx)(N.a,{color:"inherit",component:W.b,to:"/",children:"blogs"}),Object(E.jsx)(N.a,{color:"inherit",component:W.b,to:"/users",children:"users"}),Object(E.jsxs)(I.a,{className:n.typographyStyle,component:"em",children:[e.name," logged in"]}),Object(E.jsx)(N.a,{color:"inherit",onClick:function(){return t(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:x.setToken(null),window.localStorage.removeItem("loggedBlogappUser"),t({type:"LOGOUT"});case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},children:"logout"})]})})},de=function(){var e=Object(a.useState)(""),t=Object(d.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),s=Object(d.a)(c,2),i=s[0],o=s[1],f=Object(j.c)((function(e){return e.blogs})),h=Object(j.c)((function(e){return e.notification})),O=Object(j.c)((function(e){return e.user})),v=Object(j.b)();Object(a.useEffect)((function(){v(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.getAll();case 2:n=e.sent,t({type:"INIT_BLOGS",payload:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]),Object(a.useEffect)((function(){v(function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=window.localStorage.getItem("loggedBlogappUser")){e.next=3;break}return e.abrupt("return",void 0);case 3:r=JSON.parse(n),x.setToken(r.token),t({type:"LOGIN",payload:r});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[]);var m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",n=5;v(g({message:e,status:t},n))},y=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),v(V(n,i)),r(""),o("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,r,a,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,r=t.name,a=t.password,e.prev=1,e.next=4,K.create({username:n,name:r,password:a});case 4:v(V(n,a)),e.next=15;break;case 7:if(e.prev=7,e.t0=e.catch(1),c=e.t0.response.data.error,s="The username: '".concat(n,"' has already been taken"),"expected `username` to be unique",!c.includes("expected `username` to be unique")){e.next=14;break}return e.abrupt("return",m(s,"error"));case 14:m(c,"error");case 15:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),S=function(e){return function(t){var n=t.target;e(n.value)}},T=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{v(w(t)),I.current.toggleVisibility(),m("a new blog ".concat(t.title," by ").concat(t.author," added"))}catch(n){m(n.response.data.error,"error")}case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=Object(a.useRef)(),C=Object(a.useRef)(),L=f.sort((function(e,t){return t.likes-e.likes}));return null===O?Object(E.jsxs)(b.Container,{children:[Object(E.jsx)(b.Typography,{variant:"h4",component:"h2",children:"Log in to application"}),Object(E.jsx)(q,{notification:h}),Object(E.jsx)(G,{username:n,password:i,handleLogin:y,handleUsernameChange:S(r),handlePasswordChange:S(o)}),Object(E.jsx)(z,{buttonLabel:"Sign Up",ref:C,children:Object(E.jsx)(F,{handleSignUp:k})})]}):Object(E.jsxs)(b.Container,{children:[Object(E.jsx)(b.Typography,{variant:"h4",component:"h2",children:"blogs"}),Object(E.jsx)(le,{}),Object(E.jsx)(q,{notification:h}),Object(E.jsxs)(p.c,{children:[Object(E.jsx)(p.a,{path:"/users/:id",children:Object(E.jsx)(ce,{})}),Object(E.jsx)(p.a,{path:"/users",children:Object(E.jsx)(re,{})}),Object(E.jsx)(p.a,{path:"/blogs/:id",children:Object(E.jsx)(_,{setNotification:m})}),Object(E.jsxs)(p.a,{path:"/",children:[Object(E.jsx)(z,{buttonLabel:"create new blog",ref:I,children:Object(E.jsx)(R,{createBlog:T})}),Object(E.jsx)(ae,{blogs:L})]})]})]})},je=(n(279),n(91)),pe=n(224),be=n(225),fe=Object(je.combineReducers)({blogs:T,notification:y,user:M,users:Q}),he=Object(je.createStore)(fe,Object(pe.composeWithDevTools)(Object(je.applyMiddleware)(be.a)));i.a.render(Object(E.jsx)(W.a,{children:Object(E.jsx)(j.a,{store:he,children:Object(E.jsx)(de,{})})}),document.getElementById("root"))}},[[280,1,2]]]);
//# sourceMappingURL=main.800766b4.chunk.js.map